# 绘制几何体

## 帧资源

我们在每帧中都会调用 `flushCommandQueue` 函数, 确保 `GPU ` 能完成所有的命令执行. 但是却效率低下:

1.   每帧的起始阶段 `GPU` 不会执行任何的命令. 因为命令队列里面没有命令
2.   在帧结束的时候, `CPU` 要等待 `GPU` 完成命令的处理

所有 CPU 和 GPU 都有各自的空闲时间, 所有引起低效

**解决方案**

以 GPU 每帧都需要更新得资源作为基本元素, 创建一个环形数组.  我们称这些资源为帧资源, 环形数组通常是又 3 个帧资源构成的

在处理第 n 帧的时候, CPU 从资源数组中取下一个可用的帧资源, 趁着 GPU 还没处理第 n 帧时, CPU 将为第 n 帧更新资源. 此时 CPU 可以提前准备好 n+1 和 n+2 帧.

## 帧资源类

```cc
struct FrameResource {
public:
    ComPtr<ID3D12CommandAllocator>				cmdListAlloc_ = nullptr;
    unique_ptr<UploadBuffer<PassConstants>> 	passCB_ = nullptr;
    unique_ptr<UploadBuffer<ObjectConstants>> 	objectCB_ = nullptr;
};
```

